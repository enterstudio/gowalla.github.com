
---
layout: post
title: "Likeable: Love your Objects with Redis"
author: rs
date: 2011-11-03
published: false
---

[Likeable](http://github.com/gowalla/likeable) is Gowalla's open-source Ruby library that power's all of the "Loves" on stories, comments, highlights, and more. It is built on top of [redis](http://redis.io/),  the same way that Instagram [maxed out key-value pair storage](http://instagram-engineering.tumblr.com/post/12202313862/storing-hundreds-of-millions-of-simple-key-value-pairs), to give developers all of the data they need with screaming fast response times.



<iframe width="575" height="323" src="http://www.youtube.com/embed/iJoMXUQ33Jw?rel=0&amp;hd=1" frameborder="0" allowfullscreen></iframe>


To see it in action you can head over to [My Gowalla Profile](http://gowalla.com/schneems) and love the first thing you see. Immediately you'll see the heart change colors and the like count increase by one. If  you click on that number you'll see everyone who has liked that object.

While this might seem trivial at first glance keep in mind that there dozens of elements on the page that must pull this information (how many people have loved the element, has the viewer loved it, and on some pages which of your friends have loved it). If we were doing this with a traditional [ActiveRecord](http://api.rubyonrails.org/classes/ActiveRecord/Base.html) backed model on [postgres](http://www.postgresql.org/) we could easily slow our page renders to a crawl. Using redis allows us to stay flexible and fast. 

Lets check out the some code.


## The Code

Let's say we've got a comment made on a recent Gowalla story.

    @comment = Comment.last
    @comment.like_count  #=> 0



If our hero wants to like this comment they can do it like this:

    @user = User.find_by_username('schneems')
    @user.like! @comment

And thats it, our comment now has all the data associated with that like

    @comment.like_count      #=> 1
    @comment.likes           #=> [#<Likeable::Like ... >]
    @comment.likes.last.user #=> #<User username: "schneems" ...>



## The Install


Gemfile:

    gem 'likeable'


Set up your Redis connection in `initializers/likeable.rb`


    Likeable.setup do |likeable|
       likeable.redis  = Redis.new
     end



Then add the `Likeable::UserMethods` module to models/user.rb:


    class User < ActiveRecord::Base
      include Likeable::UserMethods
    end



Finally add `Likeable` module to any model you want to be liked.

    class Comment ActiveRecord::Base
      include Likeable
    end


For more info check out the [Likeable source](http://github.com/gowalla/likeable) or you can download the [Likeable Example Rails App](https://github.com/schneems/likeable_example) or [watch the likeable screencast](http://www.youtube.com/watch?v=iJoMXUQ33Jw).

## Contributing

If you'd like to contribute to [Likeable](http://github.com/gowalla/likeable), we would most certainly appreciate the help. Open an issue on GitHub, or if you feel so inclined, create a patch and submit a pull request.